function sendPeriscopeReports() {
  
  // Import .csv file from URL to the current active sheet 
  // Provide the full URL of the CSV file available at chat format -> advanced -> Expose public csv URL
  var csvUrl = "https://app.periscopedata.com/api/iguanafix/chart/csv/ff990ac3-53df-2451-9cc6-36866f7182e6";
  var csvContent = UrlFetchApp.fetch(csvUrl).getContentText();
  var csvData = Utilities.parseCsv(csvContent);  
  var sheet = SpreadsheetApp.getActiveSheet();
  sheet.getRange(1, 1, csvData.length, csvData[0].length).setValues(csvData);
  
  // refresh spreadsheet
  SpreadsheetApp.flush();
  
  // Send email with the current active spreadsheet attached 
  try {
    var ss = SpreadsheetApp.getActive();    
    var url = "https://docs.google.com/feeds/download/spreadsheets/Export?key=" + ss.getId() + "&exportFormat=xlsx";
    var params = {
      method      : "get",
      headers     : {"Authorization": "Bearer " + ScriptApp.getOAuthToken()},
      muteHttpExceptions: true
    };
    
    var blob = UrlFetchApp.fetch(url, params).getBlob();
    
    blob.setName(ss.getName() + ".xlsx");
    
    // Edit email recipients, subject and body message 
    MailApp.sendEmail("carlos.ramirez@iguanafix.com",   // Recipients 
                      "Reporte Semanal IguanaFix Nuevo Test",                                 // Subject
                      "Estimado usuario: \n \n     Su reporte está listo!! Gracias por su confianza en IguanaFix.",      // Body message
                      {attachments: [blob]});
    
  } catch (f) {
    Logger.log(f.toString());
  }
}

